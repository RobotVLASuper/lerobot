name: lerobot

services:
  lerobot:
    image: lerobot-env
    build:
      context: .
      dockerfile: docker/lerobot-compose/Dockerfile
    tty: true
    volumes:
      # Necessary for display passthrough
      - "/tmp/.X11-unix:/tmp/.X11-unix:rw"
      # Mount the current directory so users are not confused about data saving locations
      - ".:/lerobot"
      # Pass through USB devices
      - "/dev:/dev"
    environment:
      # Necessary for display passthrough
      DISPLAY: $DISPLAY
    # Give the container as much access as possible to the host machine.
    # Folks using this library might be less familiar with how docker isolates devices
    # such as USB or networks, so removing that layer is helpful for the purposes of
    # development on this library.
    #
    # For production, remove the following line and add the necessary devices and networks
    privileged: true
    network_mode: host
    ports:
      # Required for rerun, in visualize_interface.py
      - 9876:9876
      # Default port for visualize_interface_html.py
      - 9090:9090
    cap_add:
      - ALL
